
CREATE TABLE customer (
  customer_id SERIAL,
  username VARCHAR(50),
  first_name varchar(255),
  last_name VARCHAR(50),
  country varchar(255),
  town VARCHAR(255),
  is_active boolean,
  PRIMARY KEY (customer_id)
);

CREATE TABLE product (
  product_id SERIAL,
  product_name VARCHAR(50),
  description varchar(255),
  price float,
  mrp float,
  pieces_per_case int,
  weight_per_piece float,
  uom VARCHAR(50),
  brand varchar(255),
  category VARCHAR(50),
  tax_percent int,
  active boolean,
  created_by varchar(255),
  created_date timestamp,
  updated_by varchar(255),
  updated_date timestamp,
  PRIMARY KEY (product_id)
);
id	transaction_id	bill_no	bill_date	bill_location	customer_id	product_id	qty	uom	price	gross_price	tax_pc	tax_amt	discount_pc	discount_amt	net_bill_amt	created_by	created_date	updated_by	updated_date
CREATE TABLE sales (
  id SERIAL,
  transaction_id int,
  bill_no int,
  bill_date timestamp,
  bill_location VARCHAR(50),
  customer_id int,
  product_id int,
  qty int,
  uom varchar(255),
  price float,
  gross_price float,
  tax_pc int,
  tax_amt float,
  discount_pc int,
  discount_amt int,
  net_bill_amt float,
  created_by varchar(255),
  created_date timestamp,
  updated_by varchar(255),
  updated_date timestamp,
  PRIMARY KEY (id)
);
												
CREATE TABLE employee_raw (
  employee_id SERIAL,
  first_name VARCHAR(50),
  last_name varchar(255),
  department_id int,
  department_name varchar(255),
  manager_employee_id int,
  employee_role VARCHAR(50),
  salary int,
  hire_date date,
  terminated_date date,
  terminated_reason varchar(255),
  dob date,
  fte float,
  location varchar(255),
  PRIMARY KEY (employee_id)
);

client_employee_id	department_id	first_name	last_name	manager_employee_id	salary	hire_date	term_date	term_reason	dob	fte	fte_status	weekly_hours	role	is_active											
CREATE TABLE employee (
  client_employee_id SERIAL,
  department_id int,
  first_name VARCHAR(50),
  last_name varchar(255),
  manager_employee_id int,
  salary int,
  hire_date date,
  term_date date,
  term_reason varchar(255),
  dob date,
  fte float,
  fte_status varchar(255),
  weekly_hours int,
  role varchar(255),
  is_active boolean,
  PRIMARY KEY (client_employee_id)
);

CREATE TABLE timesheet_raw (
  employee_id int,
  cost_center int,
  punch_in_time timestamp,
  punch_out_time timestamp,
  punch_apply_date date,
  hours_worked float,
  paycode varchar(255)
);

CREATE TABLE timesheet (
  employee_id int,
  department_id int,
  shift_start_time time,
  shift_end_time time,
  shift_date date,
  shift_type varchar(255),
  hours_worked float,
  attendance boolean,
  has_taken_break boolean,
  break_hour float,
  was_charge boolean,
  charge_hour int,
  was_on_call boolean,
  on_call_hour int,
  num_teammates_absent int
);

COPY customer(customer_id,username,first_name,last_name,country,town,is_active)
FROM 'D:\customer.csv'
DELIMITER ','
CSV HEADER;

COPY product
FROM 'D:\product.csv'
DELIMITER ','
CSV HEADER;


COPY employee_raw
FROM 'D:\employee_raw.csv'
DELIMITER ','
CSV HEADER;

COPY employee
FROM 'D:\employee.csv'
DELIMITER ','
CSV HEADER;

COPY timesheet_raw
FROM 'D:\timesheet_raw.csv'
DELIMITER ','
CSV HEADER;

COPY timesheet
FROM 'D:\timesheet.csv'
DELIMITER ','
CSV HEADER;

select * from customer;
select * from product;
select * from employee_raw;
select * from employee;
select * from timesheet_raw;
select * from timesheet;

--Check if a single employee is listed twice with multiple ids.
select count(*) as rec_count,
  case
  	when count(*)>0 then 'failed multiple id for same cus detected'
  	else 'no multiple cus with multiple ids '
  end as test_status
from customer 
group by username
having count(username)>1;

--Check if part time employees are assigned other fte_status.


  



